set -e

function doBuild {
  go build --tags $1 .
  rm -rf $1.app
  mkdir -p $1.app/Contents/MacOS
  mkdir -p $1.app/Contents/lib
  mv magnus $1.app/Contents/MacOS/$1
  cp ~/code/src/github.com/runningwild/glop/gos/darwin/lib/libglop.so lib/darwin/
  cp lib/darwin/* $1.app/Contents/lib/
  cp -r data/* $1.app/Contents/
}

doBuild 'standard'
open standard.app
false

doBuild 'host'
#open host.app
#false
doBuild 'client'

open host.app
sleep 0.9
open client.app
